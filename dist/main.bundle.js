!function(e){function t(t){for(var i,s,r=t[0],d=t[1],l=t[2],h=0,u=[];h<r.length;h++)s=r[h],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&u.push(o[s][0]),o[s]=0;for(i in d)Object.prototype.hasOwnProperty.call(d,i)&&(e[i]=d[i]);for(c&&c(t);u.length;)u.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,r=1;r<n.length;r++){var d=n[r];0!==o[d]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},o={0:0},a=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window.webpackJsonp=window.webpackJsonp||[],d=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var c=d;a.push([22,1]),n()}({15:function(e,t,n){var i=n(16),o=n(17);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var a={insert:"head",singleton:!1};i(o,a);e.exports=o.locals||{}},17:function(e,t,n){"use strict";n.r(t);var i=n(6),o=n.n(i),a=n(11),s=o()(!1);s.i(a.a),s.push([e.i,"/* @import '../../node_modules/bootstrap/dist/css/bootstrap.min.css'; */\r\n/* @import './../scss/custom.scss'; */\r\n\r\n\r\nbody { \r\n    margin:0; \r\n    padding:0; \r\n    background-color:#000; \r\n    overflow: hidden;\r\n}\r\ncanvas { \r\n    width: 100%; \r\n    height: 100%;\r\n    /* z-index:-1; */\r\n}",""]),t.default=s},22:function(e,t,n){"use strict";n.r(t);n(15);var i=n(8),o=n(0),a=n(5),s=n(2),r=n(12),d=n.n(r),l={maxAnisotropy:0,dpr:1,scene:{background:460551},fog:{color:460551,near:.007},camera:{fov:40,near:1,far:500,aspect:1,position:{x:0,y:1.7,z:-5}},postprocessing:{focalLength:.8,focus:4,darkness:.4,luminanceThreshold:.1,luminanceSmoothing:.2,CAoffset:.001},block:{count:3,depth:8,width:4,height:2.4,thickness:.2},rectLight:{mesh:{width:1.5,height:.04,depth:.2,color:8947746,emissive:6710835,offEmissive:131586},crash:{enabled:!0,number:2,angle:90},position:{x:0,z:-2},color:16777130,intensity:18,width:2,height:.2},turnLight:{color:16729088,intensity:.9,distance:7,angle:Math.PI/2.5,exponent:1,decay:1.5,material:{offEmissive:328960,emissive:16746496},position:{x:0,z:1}},hemiLight:{hColor:0,sColor:0,lColor:1,groundHColor:.4,groundSColor:1,groundLColor:.5,intensity:.06,x:0,y:-1,z:0},controls:{autoRotate:!1,autoRotateSpeed:-.1,rotateSpeed:.1,enableDamping:!0,dampingFactor:.15,enableZoom:!0,zoomSpeed:1.8,minDistance:2,maxDistance:3,minPolarAngle:Math.PI/2.5,maxPolarAngle:Math.PI/1.8,minAzimuthAngle:-Math.PI,maxAzimuthAngle:Math.PI,enablePan:!1,target:{x:0,y:2,z:15}},ambientLight:{enabled:!1,color:5592405},shadow:{enabled:!1,helperEnabled:!1,bias:-1e-4,mapWidth:4096,mapHeight:4096,near:40,far:70,top:50,right:50,bottom:-50,left:-50},directionalLight:{castShadow:!1,colorH:.1,colorS:.8,colorL:.9,intensity:.2,x:0,y:0,z:-1,multiplyScalarPosition:10}};class c{constructor(e,t){const n=l.controls;this.camera=e;const i=(new o.yb).copy(n.target);let a=0,s=0,r=0,d=0;function c(e){const t=window.innerWidth>>1,n=window.innerHeight>>1;a=e.clientX-t,s=e.clientY-n,r=a/(window.innerWidth/2),d=s/(window.innerHeight/2)}t.addEventListener("mousemove",c,!1),t.addEventListener("touchmove",(function(e){e.preventDefault(),c(e.touches[0])}),!1),this.update=function(){i.x+=(5*-r-i.x)/10,i.y+=(-5*d+1-i.y)/50,e.lookAt(i)}}}class h{constructor(e){this.container=e,this.threeRenderer=new o.Cb({antialias:!1}),this.threeRenderer.setPixelRatio(window.devicePixelRatio),e.appendChild(this.threeRenderer.domElement),this.threeRenderer.shadowMap.enabled=l.shadow.enabled,this.threeRenderer.shadowMap.type=o.T,l.maxAnisotropy=this.threeRenderer.capabilities.getMaxAnisotropy(),this.updateSize(),document.addEventListener("DOMContentLoaded",()=>this.updateSize(),!1),window.addEventListener("resize",()=>this.updateSize(),!1)}updateSize(){this.threeRenderer.setSize(window.innerWidth,window.innerHeight)}render(e,t){this.threeRenderer.render(e,t)}}class u{constructor(e){const t=l.camera.fov,n=l.camera.near,i=l.camera.far,a=e.domElement.width/e.domElement.height;this.threeCamera=new o.U(t,a,n,i),this.threeCamera.position.copy(l.camera.position),this.updateSize(e),window.addEventListener("resize",()=>this.updateSize(e),!1)}updateSize(e){this.threeCamera.aspect=e.domElement.width/e.domElement.height,this.threeCamera.updateProjectionMatrix()}}var p=n(1),m=n.n(p),g=n(3),f=n(4);g.b.add(f.e);class b{constructor(e){const t=document.createElement("div");t.className="d-flex justify-content-between align-items-center position-absolute fixed-bottom mb-2 mr-2",e.appendChild(t);const n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");t.appendChild(n),t.appendChild(i),t.appendChild(o);const a=document.createElement("span");a.innerHTML=Object(g.a)(f.a,{styles:{color:"#fff",filter:"drop-shadow(0px 0px 3px rgba(0,0,0))"},classes:["fa-lg","text-warning"]}).html,a.className="bg-transparent",a.setAttribute("type","button"),this.playButton=a;const s=document.createElement("span");s.innerHTML=Object(g.a)(f.g,{classes:["fa-lg","text-primary"]}).html,s.style.textShadow="0 0 8px white",s.className="bg-transparent",s.setAttribute("type","button"),m()(s).hide(),this.resetButton=s,i.appendChild(a),i.appendChild(s);const r=document.createElement("button");r.className="shadow-none text-black ml-3 bg-transparent border-0 p-2",r.setAttribute("type","button");const d=Object(g.a)(f.f,{classes:["fa-lg","text-dark"]}).html;r.innerHTML=d,r.onclick=function(){m()(u).fadeToggle(),m()(p).is(":visible")&&m()(p).hide()};const c=document.createElement("button");c.className="text-black ml-3 bg-transparent border-0 p-2",c.setAttribute("type","button"),c.innerHTML=Object(g.a)(f.b,{classes:["fa-lg","text-dark"]}).html,c.onclick=function(){m()(p).fadeToggle(),m()(u).is(":visible")&&m()(u).hide()};const h=document.createElement("button");h.className="text-black ml-3 bg-transparent border-0 p-2",h.setAttribute("type","button"),this.vol=Object(g.a)(f.i,{classes:["fa-lg","text-primary"]}).html,h.innerHTML=this.vol,this.mute=Object(g.a)(f.h,{classes:["text-dark","fa-lg"]}).html,this.tray=h,n.appendChild(r),n.appendChild(c),n.appendChild(h),this.fullIcon=Object(g.a)(f.d,{classes:["text-dark","fa-lg"]}).html,this.shrinkIcon=Object(g.a)(f.c,{classes:["text-dark","fa-lg"]}).html,this.button3=document.createElement("span"),this.button3.className="text-black ml-3 bg-transparent border-0 p-2",this.button3.setAttribute("type","button"),this.button3.style.right=0,this.button3.style.bottom=0,this.button3.innerHTML=this.fullIcon,o.appendChild(this.button3);const u=document.createElement("div");u.className="position-absolute bg-dark text-secondary p-2 m-4 card",u.style.top=0,u.innerHTML='\n        <div class="card-body">\n            <div class="card mb-3 bg-secondary text-white">\n                <div class="card-header">\n                    Tunnel Demo (2019)\n                </div>\n                <div class="card-body bg-dark">\n                    Three.js r119, Shader-Particle-Engine, Rectangle-Area Lights, Postprocessing\n                </div>\n            </div>\n            <div class="card bg-secondary text-light">\n                <div class="card-header">References</div>\n                    <table class="table table-dark mb-0">\n                        <thead class="thead-dark">\n                            <tr>\n                                <th>Artist</th>\n                                <th>Work</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                        <tr>\n                            <td>Yughues</td>\n                            <td><a href="https://www.deviantart.com/yughues/art/Free-textures-pack-41-352194217" target="_blank">Free textures pack 41</a></td>\n                        </tr>\n                        <tr>\n                            <td>ModulationStation</td>\n                            <td><a href="https://freesound.org/people/ModulationStation/sounds/131599/" target="_blank">Kill Switch</a></td>\n                        </tr>\n                        <tr>\n                            <td>mirkosukovic</td>\n                            <td><a href="https://freesound.org/people/mirkosukovic/sounds/435666/" target="_blank">Alarm Siren</a></td>\n                        </tr>\n                        <tr>\n                            <td>iSaria</td>\n                            <td><a href="https://freesound.org/people/iSaria/sounds/326261/" target="_blank">zombi purr 2</a></td>\n                        </tr>\n                        <tr>\n                            <td>steveygos93</td>\n                            <td><a href="https://freesound.org/people/steveygos93/sounds/80401/" target="_blank">Explosion 2</a></td>\n                        </tr>\n                        <tr>\n                            <td>kingof_thelab</td>\n                            <td><a href="https://freesound.org/people/kingof_thelab/sounds/340255/" target="_blank">Steam Loop Body</a></td>\n                        </tr>\n                        <tr>\n                            <td>LamaMakesMusic</td>\n                            <td><a href="https://freesound.org/people/LamaMakesMusic/sounds/403537/" target="_blank">Door_Heavy_Reverb_Open_Close</a></td>\n                        </tr>\n                        <tr>\n                            <td> felixmariotto </td>\n                            <td><a href="https://github.com/felixmariotto/three-screenshake" target="_blank">Camera Shake</a></td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n        </div>',m()(u).hide(),e.appendChild(u);const p=document.createElement("div");p.className="position-absolute bg-dark text-secondary p-2 m-4 card",p.style.top=0,p.innerHTML='\n        <div class="card-body">\n        <div class="input-group" role="group" aria-label="Basic example">\n        <div class="input-group-prepend">\n            <div class="input-group-text" id="btnGroupAddon">/?lights=</div>\n        </div>\n        <input type="number" class="form-control" placeholder="'+l.block.count+'" id="lightInput" aria-label="Input group example" aria-describedby="btnGroupAddon">\n        <button type="button" onclick="{ \n            window.location.href = location.protocol + \'//\' + location.host + location.pathname +\'?lights=\'+ document.getElementById(\'lightInput\').value; \n        }" class="btn btn-secondary">reload</button>\n        </div>\n      </div>',m()(p).hide(),e.appendChild(p)}}class w{constructor(e,t,n,i){let a=0,s=void 0,r=n.slice(0),d=!1,l=!0;const c=new o.db;c.layers.set(1);const h=new o.xb,u=new b(e);function p(){l=!l,r=n.slice(0)}function g(){r.length>0&&(d=!0,m()(u.playButton).fadeOut(),m()(u.resetButton).fadeOut())}u.playButton.onclick=()=>{n[0].button.userData.move(!1),g()},u.resetButton.onclick=()=>{p(),n[0].button.userData.move(!0),g()},this.update=function(e){n.forEach(t=>t.update(e)),a+=e,!d||r.length<1||a<1||(s=r.pop(),a=0,l?s.off():s.on(),0===r.length&&(d=!1,l?setTimeout(()=>{d||m()(u.resetButton).fadeIn()},3e3):(p(),m()(u.playButton).fadeIn())))},u.button3.onclick=function(){var e,t,n,i;this.toggle?u.button3.innerHTML=u.fullIcon:u.button3.innerHTML=u.shrinkIcon,this.toggle=!this.toggle,e=window.document,t=e.documentElement,n=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,i=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen,e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?i.call(e):n.call(t)},u.tray.onclick=function(){this.toggle?(this.toggle=!1,t.setMasterVolume(1),u.tray.innerHTML=u.vol):(this.toggle=!0,t.setMasterVolume(0),u.tray.innerHTML=u.mute)},e.addEventListener("mousedown",(function(){w.length>0&&(0!==r.length&&l?(w[0].object.userData.move(!1),g()):(w[0].object.userData.move(!0),p(),g()))}),!1),e.addEventListener("mousemove",(function(e){h.set(e.clientX/window.innerWidth*2-1,-e.clientY/window.innerHeight*2+1),c.setFromCamera(h,i),w=c.intersectObjects(f,!0),w.length>0?document.body.style.cursor="pointer":document.body.style.cursor="default"}),!1);const f=r.map(e=>e.mesh);let w=[]}}class y{constructor(e,t){this.scene=e,this.camera=t,this.init()}init(){this.ambientLight=new o.b(l.ambientLight.color),this.hemiLight=new o.z,this.hemiLight.intensity=l.hemiLight.intensity,this.hemiLight.color.setHSL(l.hemiLight.hColor,l.hemiLight.sColor,l.hemiLight.lColor),this.hemiLight.groundColor.setHSL(l.hemiLight.groundHColor,l.hemiLight.groundSColor,l.hemiLight.groundLColor),this.hemiLight.position.set(l.hemiLight.x,l.hemiLight.y,l.hemiLight.z),this.directionalLight=new o.u,this.directionalLight.intensity=l.directionalLight.intensity,this.directionalLight.color.setHSL(l.directionalLight.colorH,l.directionalLight.colorS,l.directionalLight.colorL),this.directionalLight.position.set(l.directionalLight.x,l.directionalLight.y,l.directionalLight.z),this.directionalLight.position.multiplyScalar(l.directionalLight.multiplyScalarPosition),this.directionalLight.castShadow=l.directionalLight.castShadow,this.directionalLight.shadow.bias=l.shadow.bias,this.directionalLight.shadow.camera.near=l.shadow.near,this.directionalLight.shadow.camera.far=l.shadow.far,this.directionalLight.shadow.camera.left=l.shadow.left,this.directionalLight.shadow.camera.right=l.shadow.right,this.directionalLight.shadow.camera.top=l.shadow.top,this.directionalLight.shadow.camera.bottom=l.shadow.bottom,this.directionalLight.shadow.mapSize.width=l.shadow.mapWidth,this.directionalLight.shadow.mapSize.height=l.shadow.mapHeight,this.directionalLightHelper=new o.k(this.directionalLight.shadow.camera),this.directionalLightHelper.visible=l.shadow.helperEnabled}place(e){switch(e){case"ambient":this.scene.add(this.ambientLight);break;case"spot":this.scene.add(this.spotlight),this.scene.add(this.spotlight.target),this.scene.add(this.spotLightHelper);break;case"directional":this.scene.add(this.directionalLight),this.scene.add(this.directionalLightHelper);break;case"point":this.scene.add(this.pointLight);break;case"hemi":this.scene.add(this.hemiLight)}}}class v{constructor(e,t){this.turning=!0;const n=l.turnLight,i=l.block.height,a=new o.mb(l.turnLight.color,l.turnLight.intensity,l.turnLight.distance,l.turnLight.angle,l.turnLight.exponent,l.turnLight.decay);let s=t*Math.PI/2;a.userData.update=function(e){s+=4*e,a.target.position.z=n.position.z+Math.cos(s),a.target.position.x=n.position.x+Math.sin(s)},a.position.set(n.position.x,i,n.position.z),a.target.position.set(n.position.x,i-1.5,n.position.z),e.add(a),e.add(a.target);const r=new o.lb(.08,16,16),d=(new o.J).makeTranslation(0,0,-.01);r.merge(r,d,1);const c=new o.N({color:4473924,emissive:n.material.emissive}),h=new o.N({color:4465152,emissive:328960}),u=new o.K(r,[c,h]);u.position.set(0,-.08,0);const p=new o.N({color:8947848,emissive:0}),m=new o.K(new o.q(.26,.16,.13,8,2),p);e.add(m),m.add(u),m.position.set(n.position.x,i,n.position.z),m.matrixAutoUpdate=!1,m.updateMatrix();const g=new o.yb;this.on=function(){c.emissive.setHex(n.material.emissive),a.intensity=n.intensity,this.turning=!0},this.off=function(){c.emissive.setHex(n.material.offEmissive),a.intensity=0,this.turning=!1},this.update=function(e){this.turning&&(a.userData.update(e),u.lookAt(a.target.getWorldPosition(g).x,i-.5,a.target.getWorldPosition(g).z))}}}n(13).a.init();class L{constructor(e,t){const n=l.rectLight;let i=!1,a=0;const r=new o.P({color:n.mesh.color,emissive:n.mesh.emissive}),d=new o.K(new o.f(n.mesh.width,n.mesh.height,n.mesh.depth),[r,r,r,r,r,r]);d.position.set(n.position.x,l.block.height-.01,n.position.z);const c=new o.eb(n.color,n.intensity,n.width,n.height);c.rotation.set(-Math.PI/2,0,0),d.add(c);let h=new o.J,u=new o.yb,p=2*Math.random()+0;const m=Math.random()<.5;function g(e){let t=90+5*Math.sin(3*e);return m&&(t*=-1),o.H.degToRad(t)}m?(h.makeTranslation(n.mesh.width/2,0,0),u.set(n.position.x-n.mesh.width/2,l.block.height,n.position.z),c.position.set(n.position.x+n.mesh.width/2,-.05,0),p*=-1):(h.makeTranslation(-n.mesh.width/2,0,0),u.set(n.position.x+n.mesh.width/2,l.block.height,n.position.z),c.position.set(n.position.x-n.mesh.width/2,-.05,0)),d.rotation.z=o.H.degToRad(p),d.geometry.applyMatrix4(h),d.position.copy(u),d.matrixAutoUpdate=!1,d.updateMatrix(),e.add(d),this.update=function(e){i&&(a+=e,d.rotation.z=g(a),d.updateMatrix())},this.add=function(e){d.add(e)},this.on=function(){r.emissive.setHex(n.mesh.emissive),c.intensity=n.intensity,t&&(i=!1,a=0,d.rotation.z=o.H.degToRad(p),d.updateMatrix())},this.off=function(){t?setTimeout((function(){new s.a.Tween(d.rotation).to({z:g(a)},2e3).easing(s.a.Easing.Elastic.Out).onUpdate((function(){d.updateMatrix()})).onComplete((function(){i=!0})).start()}),100):(r.emissive.setHex(n.mesh.offEmissive),c.intensity=0)}}}var x=n.p+"img/70a44bdf5f784b66894022af94c59514.jpg",k=n.p+"img/7fca23f10968764371d9e3bff638c213.jpg",M=n.p+"img/31baf46e8d27ed6582ad4460cd543afe.jpg";const S=new o.pb,E=S.load(x),C=S.load(k),z=S.load(M),T=new o.Q({color:16777215,map:E,normalMap:C,metalnessMap:z,roughness:.4}),P=T.clone();T.roughness=.2,T.color.setHex(11184810);class A{constructor(){const e=new o.K(new o.f(.2,.2,.2),P),t=new o.K(new o.q(.1,.1,l.block.depth,16),T);return t.geometry.rotateX(Math.PI/2),t.position.set(l.block.width/2-.2,l.block.height-.2,0),t.matrixAutoUpdate=!1,t.updateMatrix(),t.add(e),t}}class H{constructor(e,t){const n=new o.p(11162965),i=new o.p(11184725),a=l.block.width,r=l.block.height,d=new o.K(new o.f(.1,.6,.45),e.clone());d.material.color.set(13421772),d.material.map=void 0,window.innerHeight>window.innerWidth?d.position.set(-a/2,r/2+.2,1):d.position.set(-a/2,r/2+.2,-1);const c=i.clone(),h=n.clone(),u=new o.P({}),p=new o.K(new o.f(.2,.1,.3),u);d.userData.button=p,p.layers.enable(1),d.add(p),p.material.emissive=c;let m=new s.a.Tween(c).to(new o.p(3385907),2e3).yoyo(!0).repeat(1/0).easing(s.a.Easing.Quartic.In),g=new s.a.Tween(h).to(new o.p(16724787),2e3).yoyo(!0).repeat(1/0).easing(s.a.Easing.Quartic.In);m.start(),p.userData.normal=function(){g.stop(),p.material.emissive=c,m.start()},p.userData.emergency=function(){m.stop(),p.material.emissive=h,g.start()},p.userData.isAnimating=!1,p.userData.move=function(e){this.isAnimating||(this.isAnimating=!0,t[0].play(),new s.a.Tween(p.position).to({x:-.03},200).easing(s.a.Easing.Elastic.Out).yoyo(!0).repeat(1).onStart(()=>{e?p.userData.normal():p.userData.emergency()}).onComplete(()=>{this.isAnimating=!1}).start())},d.userData.emergency=function(){b.material.emissive.set(n),y.material.emissive.set(n),M.userData.emergency(),p.userData.emergency()},d.userData.normal=function(){b.material.emissive.set(i),y.material.emissive.set(i),M.userData.normal(),p.userData.normal()},d.matrixAutoUpdate=!1,d.updateMatrix();let f=new o.m(.01,32);var b=new o.K(f,new o.P({emissive:i}));b.rotation.y=Math.PI/2,b.position.set(.051,-.15,0),d.add(b);let w=new o.V(.2,.02);var y=new o.K(w,new o.P({emissive:i}));y.rotation.y=Math.PI/2,y.position.set(.051,.2,0),d.add(y);var v=[new o.yb(0,-.5,-10),new o.yb(0,0,-10),new o.yb(0,0,-.4),new o.yb(.01,1.1,.1)],L=new o.l(v,!1,"catmullrom",.2),x=new o.qb(L,300,.01,12,!1),k=new o.P({color:10066329,emissive:10066261}),M=new o.K(x,k);return M.position.set(0,-r/2,0),M.userData.emergency=function(){M.material.emissive.set(e.emissive)},M.userData.normal=function(){M.material.emissive.set(10066261)},d.add(M),d}}var D=n(14);const R=new o.pb,j=R.load(x),O=R.load(k),_=R.load(M),I=new o.Q({color:16777215,map:j,normalMap:O,metalnessMap:_,roughness:.4,wireframe:!1});I.map.wrapS=I.map.wrapT=o.gb,I.normalMap.wrapS=I.normalMap.wrapT=o.gb,I.metalnessMap.wrapS=I.metalnessMap.wrapT=o.gb,I.map.repeat.set(2,2),I.normalMap.repeat.set(2,2),I.metalnessMap.repeat.set(2,2),I.map.anisotropy=l.maxAnisotropy,I.normalMap.anisotropy=l.maxAnisotropy,I.metalnessMap.anisotropy=l.maxAnisotropy;class B{constructor(e,t){this.sounds=[],this.bonusSounds=[],this.sound_switch=[];let n=void 0;const i=l.block.depth,a=l.block.width,r=l.block.height,d=l.block.thickness,c=new o.g(d,r,i),h=new o.g(a,d,i);h.applyMatrix4((new o.J).makeTranslation(0,-d/2,0)),h.merge(h,(new o.J).makeTranslation(0,r+d,0)),h.merge(c,(new o.J).makeTranslation(a/2+d/2,r/2,0)),h.merge(c,(new o.J).makeTranslation(-a/2-d/2,r/2,0));const u=new o.K(h,I);u.matrixAutoUpdate=!1,u.position.set(0,0,e*i),u.updateMatrix(),this.mesh=u;const p=new A;u.add(p);let m=!1;e%4==0&&(m=new H(I,this.sound_switch),u.add(m),this.button=m.userData.button);let g=!1;e%3==0&&(g=new v(u,e),g.off());const f=l.rectLight.crash.enabled&&e===l.rectLight.crash.number-1,b=new L(u,f);let w,y;this.addParticle=function(e,t){w=e,y=new D.a(t)},this.update=function(e){g&&g.update(e),b&&f&&b.update(e),y&&y.update()},this.offSound=function(e){n=e},this.addSound=function(e){this.sounds.push(e),b&&b.add(e)},this.addBonusSound=function(e){this.bonusSounds.push(e),u.add(e)},this.on=function(){if(m&&m.userData.normal(),b&&b.on(),g&&g.off(),t){t.play();const e={x:0};new s.a.Tween(e).to({x:1},1e3).onUpdate((function(){t.setVolume(e.x)})).onComplete((function(){})).start()}this.bonusSounds&&(this.bonusSounds.forEach(e=>e.stop()),w&&w.stop()),this.sounds.forEach(e=>e.play())},this.off=function(){m&&m.userData.emergency(),b&&b.off(),g&&g.on(),t&&t.stop(),n&&n.play(),f||this.sounds.forEach(e=>e.play()),this.bonusSounds&&(w&&(w.start(),y.shake(new o.yb(Math.random(),.1,.2),300)),this.bonusSounds.forEach(e=>e.play()))}}}var F=n(9),K=n.p+"img/3b57b972334ff0a1218afc61d05db2cf.png",N=n.p+"media/863b6cc1c800dd2c2575bd3755fd2d87.wav";class W{constructor(e,t){let n=new F.a.Group({texture:{value:(new o.pb).load(K)},blending:o.S,maxParticleCount:1e3,fog:!1});const i=new o.yb(.05,-.05,0),a=new o.yb(-.5,.1,0);let s=new F.a.Emitter({particleCount:500,maxAge:{value:3},position:{value:new o.yb(1.5,l.block.height-1.3,-1),spread:new o.yb(0,0,0)},velocity:{value:a},acceleration:{value:i},wiggle:{spread:1},size:{value:[.01,.5],spread:2},opacity:{value:[0,.01,.04,0]},color:{value:[new o.p(.4,.3,.2),new o.p(.4,.3,.2)],spread:new o.p(.1,.1,.1)},angle:{value:[0,Math.PI]}});s.disable(),n.addEmitter(s),e.add(n.mesh),n.mesh.frustumCulled=!1,this.emitter=s,this.particleGroup=n,this.stop=function(){s.disable(),r.stop()};const r=new o.X(t);(new o.e).load(N,(function(e){r.setBuffer(e),r.setLoop(!0),r.setVolume(10),n.mesh.add(r)})),this.start=function(){r.play(),s.enable()},this.update=function(e){n&&n.tick(e)}}}var V=n.p+"media/6bdfc0ad4e99c65e5bfed45a7f540596.ogg",U=n.p+"media/de4e4c2e6d3526b22b3a8d0fdbd37179.wav",q=n.p+"media/14444e422cd59f6a69d2860d4b883705.wav",J=n.p+"media/07a9dece223192980f84695d58b2de70.ogg",G=n.p+"media/da2794361988a2d5dfc4367ea96e8c3f.ogg",X=n.p+"media/ef6f372f65b893bab810975c29528d10.ogg";if(i.a.isWebGLAvailable())!function(){const e=document.body,t=new o.o;let n=0;const i=new o.hb;i.background=new o.p(l.scene.background),i.fog=new o.y(l.fog.color,l.fog.near);const r=new d.a;e.appendChild(r.dom);const p=new h(e),m=new u(p.threeRenderer),g=new c(m.threeCamera,p.threeRenderer.domElement,i),f=new a.c(p.threeRenderer),b=new a.e({luminanceGain:2,luminanceThreshold:.2,fringe:0,focalLength:l.postprocessing.focalLength,focus:l.postprocessing.focus}),v=new a.b({offset:new o.xb(l.postprocessing.CAoffset,l.postprocessing.CAoffset)}),L=new a.g({darkness:l.postprocessing.darkness}),x=new a.a({luminanceThreshold:l.postprocessing.luminanceThreshold,luminanceSmoothing:l.postprocessing.luminanceSmoothing}),k=new a.d(m.threeCamera,L,x,v),M=new a.d(m.threeCamera,b);f.addPass(new a.f(i,m.threeCamera)),f.addPass(k),f.addPass(M);const S=new y(i);["hemi"].forEach(e=>S.place(e));const E=new o.d;m.threeCamera.add(E);const C=new o.c(E),z=new o.c(E),T=new o.c(E),P=new W(i,E),A=new URL(window.location.href).searchParams.get("lights")||l.block.count,H=[];for(let e=0;e<A;e++)if(0===e){const t=new B(e,C);H.push(t),i.add(t.mesh)}else{const t=new B(e);H.push(t),i.add(t.mesh)}const D=new w(e,E,H,m.threeCamera),R=new o.e;R.load(J,(function(e){C.setBuffer(e),C.setLoop(!0),C.setVolume(.5),C.play()})),R.load(X,(function(e){T.setBuffer(e),T.setLoop(!1),T.setVolume(.5),H[0].sound_switch.push(T)})),R.load(G,(function(e){z.setBuffer(e),z.setVolume(.5);const t=H.length<2?0:l.rectLight.crash.number-1;H[t].offSound(z),H[t].addParticle(P,m.threeCamera)})),R.load(V,(function(e){H.forEach(t=>{const n=new o.X(E);n.setBuffer(e),n.setRefDistance(8),t.addSound(n)})})),R.load(U,(function(e){const t=new o.X(E);t.setBuffer(e),t.setRefDistance(8),t.setVolume(4),H[0].addBonusSound(t)})),R.load(q,(function(e){H.forEach((t,n)=>{if(n%3==0){const n=new o.X(E);n.setBuffer(e),n.setRefDistance(4),n.setVolume(.2),n.setLoop(!0),t.addBonusSound(n)}})})),function e(){requestAnimationFrame(e),n=t.getDelta(),function(e){s.a.update(),r.update(),P.update(e),D.update(e),g.update()}(n),f.render(n)}()}();else{const e=i.a.getWebGLErrorMessage();document.body.appendChild(e)}}});